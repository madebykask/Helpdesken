@model ECT.FormLib.Models.FormModel
@using ECT.FormLib;
@using ECT.FormLib.Models;

@{
    ViewBag.Title = Model.Translate("Netherlands") + " - " + Model.Translate("Service Request Details");
    //var firstEventVal = TempData["FirstEventVal"];
    //var lockedFields = TempData["LockedFields"];
    //var PublicHasEvent = TempData["HasEvent"];
    //var appliedEventName = TempData["AppliedEventName"];
    //var canApplyRule = TempData["CanApplyRule"];
    //var lastValidation = TempData["LastValidation"];
    //var allEvents = Model.events;    
}



@section Validation {

    @*@Html.Partial("_Validate", Model)*@

}

@* Change Terms Conditions Temporary solution*@
@*@section Script {*@

  @*  <script type="text/javascript">
        
        $(document).on('change', '#actionState', function (e) {            
            var val = $(this).val();
            if (val != "" && $('#FirstEventName').val() != "") {
                var allFieldname = $('#FirstEventName').val();
                return $.ajax({
                    url: site.baseUrl + '/Netherlands/ChangeTermsConditions/ChangeRules/',
                    type: 'post',
                    data: { id: val, eventFieldName: allFieldname },
                    dataType: 'json',
                    success: function (result) {
                        $('#validate_' + val).val(result);
                        $('#LastValidation').val(result);
                        validate.run(val);
                    }
                });
            }
            else {

                validate.run(val);
            }
        });



        var iconFlag = '<i class="icon-flag"></i>';
        var elemOld = $('input[name^="OLD_"]');
        var elem = new Array();      

        elemOld.each(function (e) {
            var $this = $(this);
            var $that = $('#' + $this.attr('id').replace('OLD_', ''));
            var txt = $that.find('option:selected').text();
            $this.parent().find('.icon-flag').remove();

            if ($that.val() !== $this.val() && $this.parent().find('.icon-flag').length == 0)
                $this.parent().prepend($(iconFlag));

            if (txt == $this.val() && $this.parent().find('.icon-flag').length > 0)
                $this.parent().find('.icon-flag').remove();

            var tagName = $that.get(0).tagName;


            if ($that.is('input')) {

                $that.keyup(function (e) {
                    var old = $('#OLD_' + $(this).attr('id'));
                    old.parent().find('.icon-flag').remove();

                    if ($(this).val() !== old.val().replace(/[\r\n]/g, "") && old.parent().find('.icon-flag').length == 0) {
                        var formfiledName = $that.attr('id');
                        old.parent().prepend($(iconFlag));
                    }
                });
            }


            if ($that.is('select')) {
                $that.change(function (e) {

                    var old = $('#OLD_' + $(this).attr('id'));

                    old.parent().find('.icon-flag').remove();


                    if (txt == old.val().replace(/[\r\n]/g, "") && old.parent().find('.icon-flag').length > 0) {
                        old.parent().find('.icon-flag').remove();
                    }

                    if (txt !== old.val().replace(/[\r\n]/g, "") && old.parent().find('.icon-flag').length == 0) {
                        var formfiledName = $that.attr('id');
                        old.parent().prepend($(iconFlag));
                    }

                    if ($(this).val() !== " ") {
                        if ($(this).val() !== old.val().replace(/[\r\n]/g, "") && old.parent().find('.icon-flag').length == 0) {
                            var formfiledName = $that.attr('id');
                            old.parent().prepend($(iconFlag));
                        }
                    }
                });
            }
        });
      
    </script>*@

@*}*@

@*<input type="hidden" name="LastValidation" id="LastValidation" value="@lastValidation" />
<input type="hidden" name="LockedFields" id="LockedFields" value="@lockedFields" />
<input type="hidden" name="HasEvent" id="HasEvent" value="@PublicHasEvent" />
<input type="hidden" name="AppliedEventName" id="AppliedEventName" value="@appliedEventName" />
<input type="hidden" name="CanApplyRule" id="CanApplyRule" value="@canApplyRule" />
<input type="hidden" name="FirstEventName" id="FirstEventName" value="@firstEventVal" />*@

@Html.Partial("_Edit", Model)

