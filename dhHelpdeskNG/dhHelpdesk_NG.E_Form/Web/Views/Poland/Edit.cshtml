@model Web.Models.Poland.NewHireModel
@using Web;
@{
    ViewBag.Title = "Hiring";
    var iframe = Html.MasterModel().Iframe != string.Empty;  
}
@section Script {
    <script>

        var reload = function () {
            //window.parent.close();
            location.reload();
        };

        $(document).on('click', '#actionStateChange', function (e) {
            if ($('#actionState').val() == '')
                e.preventDefault();
            else {
                @{
                    if(iframe)
                    {
                    <text>
                var form = $('form');
                var formData = form.serialize();
                var url = form.attr('action');
                var btn = $('#actionStateChange');
                var oldText = btn.html();

                btn.css('cursor', 'wait');
                $('html').css('cursor', 'wait');

                btn.html('@Model.Translate("Loading...")');

                $.ajax({
                    type: "POST",
                    url: url,
                    data: formData
                })
                .done(function (data) {

                    btn.html(oldText);
                    $('html').css('cursor', 'default');
                    if (data.View != '') {
                        $('form').replaceWith(data.View);
                        init();
                    } else {
                        reload();
                    }
                });

                return false;
                </text>
                    }
                }
            }
        });

    </script>
}
@Html.Partial("_Edit", Model)