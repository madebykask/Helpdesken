use dh_support

declare @formId int
declare @formFieldName nvarchar(250)
declare @formElement nvarchar(250)
declare @type nvarchar (10)

set @formId = 21

print '<?xml version="1.0" encoding="utf-8" ?>
			<form id="' + convert(nvarchar(50), @formId) + '">
				<fields>
				<!-- 
				Attribute name and type are required 
				Use attribute required="1" message="Required" for mandatory fields  
				-->
				'

declare ff cursor for
select FormFieldName  from tblFormField where Form_Id = @formId
open ff
fetch next from ff 
into  @formFieldName
while @@FETCH_STATUS = 0
begin
		
	if(CHARINDEX('txt', @formFieldName) > 0 )
		set @type = 'text'
	if(CHARINDEX('dt', @formFieldName) > 0 )
		set @type = 'date'
	if(CHARINDEX('opt', @formFieldName) > 0 )
		set @type = 'radio'
	if(CHARINDEX('lst', @formFieldName) > 0 )
		set @type = 'select'
	if(CHARINDEX('chk', @formFieldName) > 0 )
		set @type = 'checkbox'
		
	set @formElement = replace(@formFieldName, 'txt', '')
	set @formElement = replace(@formElement, 'lst', '')
	set @formElement = replace(@formElement, 'opt', '')
	set @formElement = replace(@formElement, 'dt', '')
	set @formElement = replace(@formElement, 'chk', '')
	set @formElement = rtrim(@formElement)
	
	print '					<' + @formElement + ' type="' + @type + '" name="' + rtrim(@formFieldName) + '"></' + @formElement + '>'
  
	fetch next from ff into @formFieldName
end
close ff
deallocate ff

print '			</fields>
	  		</form>'