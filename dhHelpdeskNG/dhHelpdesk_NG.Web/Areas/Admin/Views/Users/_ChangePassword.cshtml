@model dhHelpdesk_NG.Web.Areas.Admin.Models.UserInputViewModel

@using dhHelpdesk_NG.Web.Infrastructure.Extensions
<div class="contentContent">
    <div class="formContainer">
        <table cellpadding="0" cellspacing="5px" border="0">
            @Translation.Get("Byte av lösenord", Enums.TranslationSource.TextTranslation)
            <tr>
                <td>
                    @Translation.Get("Nytt lösenord", Enums.TranslationSource.TextTranslation)
                </td>
                <td>
                    <input type="password" id="NewPassword" style="width: 200px;" maxlength="20" />
                </td>
            </tr>
            <tr>
                <td>
                    @Translation.Get("Bekräfta lösenord", Enums.TranslationSource.TextTranslation)
                </td>
                <td>
                    <input type="password" id="ConfirmPassword" style="width: 200px;" maxlength="20" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="button" value="@Translation.Get("Spara", Enums.TranslationSource.TextTranslation)" id="btnSavePassword" />
                </td>
                <td>
                    <input type="button" value="@Translation.Get("Avbryt", Enums.TranslationSource.TextTranslation)" id="btnClose" />
                </td>
            </tr>
        </table>
        <input type="hidden" id="id_user" value="@Model.User.Id" />
    </div>
</div>
<script type="text/javascript">

    $("#btnClose").unbind('click');
    $("#btnClose").click(function () {
        $('#divPasswordDialog').dialog("close")
    });

    $("#btnSavePassword").unbind('click');
    $("#btnSavePassword").click(function (e) {
        if ($('#NewPassword').val() != $('#ConfirmPassword').val()) {
            alert('@Translation.Get("De lösenord du angav stämmer inte överens med varandra. Försök igen", Enums.TranslationSource.TextTranslation)');
        } else {
            $.post('/users/EditUserPassword/', { id: $('#id_user').val(), newPassword: $('#NewPassword').val(), confirmPassword: $('#ConfirmPassword').val() }, function (data) {
                alert('@Translation.Get("Lösenordet har ändrats", Enums.TranslationSource.TextTranslation)');
                setTimeout(function () { $('#divPasswordDialog').dialog("close") }, 500);

                $('#NewPassword').val('');
                $('#ConfirmPassword').val('');
            });
            }
    });

</script>
