@model DH.Helpdesk.Web.Models.Case.Output.CaseSearchFilterData 
@using System.Web.Script.Serialization
@using DH.Helpdesk.BusinessData.Models.Case
@using DH.Helpdesk.BusinessData.OldComponents

@using DH.Helpdesk.Web.Infrastructure.Extensions

@{
    var jsSerializer = new JavaScriptSerializer();
    var i18n = new { selectOneOrMore = Translation.Get("Välj en eller flera", Enums.TranslationSource.TextTranslation) };
}
<script type="text/javascript">
    window.i18n = @Html.Raw(jsSerializer.Serialize(i18n))
</script>

@if (Model != null)
{       
  <form id="frmCaseSearch" name="frmCaseSearch">
     <div class="container">
         <div class="row hideable" style="display:none">
             <div data-field="caseRemainingTimeShowPlace" style="float: right;"></div>
             <div class="span12">
                 <table class="tableform">
                     <tr>
                         <td class="span3">
                             <input type="hidden" value="@Model.filterCustomerId" id="hidFilterCustomer_Id" name="hidFilterCustomerId" />                             
                         </td>
                         <td class="span4">
                         </td>
                         <td class="span5">
                         </td>
                     </tr>
                     @if (Model.customerUserSetting.CaseInitiatorFilterShow)
                     {
                         <tr>
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.Persons_Name.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 @Html.TextBoxFor(m => m.CaseInitiatorFilter, new { @class = "fixed-length", id = string.Empty })
                             </td>
                         </tr>                
                     }

                     @if (Model.filterRegion != null)
                     {
                         <tr>
                             <td>                                                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.Region_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                
                             </td>
                             <td>
                                 <select id="lstFilterRegion" name="@CaseSearchFilter.RegionNameAttribute" data-field="region" data-placeholder="@Translation.Get("Välj en eller flera", Enums.TranslationSource.TextTranslation)" multiple="multiple" class="chosen-select">
                                     @foreach (var e in Model.filterRegion)
                                     {
                                         if (e.IsActive == 1)
                                         {                        
                                             <option value="@e.Id" @e.Id.IdIsSelected(Model.caseSearchFilter.Region)>@e.Name</option>
                                         }
                                     }
                                 </select>
                             </td>
                         </tr>                
                     }
                    
                     @if (Model.filterDepartment != null)
                     {
                         <tr>
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.Department_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 <select id="lstfilterDepartment" name="@CaseSearchFilter.DepartmentNameAttribute" data-field="department" data-placeholder="@Translation.Get("Välj en eller flera", Enums.TranslationSource.TextTranslation)" multiple="multiple" class="chosen-select">
                                     @foreach (var e in Model.filterDepartment)
                                     {
                                         if (e.IsActive == 1)
                                         {                        
                                             <option value="@e.Id" @e.Id.IdIsSelected(Model.caseSearchFilter.Department)>@e.DepartmentDescription(Model.customerSetting.DepartmentFilterFormat)</option>
                                         }
                                     }
                                 </select>
                             </td>
                         </tr>                
                     }
                     @if (Model.RegisteredByUserList != null)
                     {
                         <tr>
                             <td>                                                               
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.User_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                
                             </td>
                             <td>
                                 @Html.ListBoxFor(m => m.lstfilterUser, Model.RegisteredByUserList, new { id = "lstfilterUser", @class = "chosen-select", multiple = "multiple" })
                             </td>
                         </tr>                
                     }
                     @if (Model.filterCaseType != null)
                     {
                         <tr>
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.CaseType_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                 
                             </td>
                             <td>
                                 <div id="divCaseType" class="btn-group">
                                     <div class="btn breadcrumbs">@Model.caseSearchFilter.ParantPath_CaseType</div>
                                     <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
                                         <span class="caret"></span>
                                     </button>
                                     <ul class="dropdown-menu">
                                         <li><a href="#">@Translation.Get("--", Enums.TranslationSource.TextTranslation)</a></li>
                                         @Html.CaseTypeDropdownButtonString(Model.filterCaseType)
                                     </ul>
                                     <input type="hidden" class="hidden" value="@Model.caseSearchFilter.CaseType.supressZero()" id="hidFilterCaseTypeId" name="@CaseSearchFilter.CaseTypeIdNameAttribute" />
                                 </div>

                             </td>
                         </tr>                
                     }
                     @if (Model.filterProductArea != null)
                     {
                         <tr>
                             <td>                                                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.ProductArea_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 <div id="divProductArea" class="btn-group pull-left">
                                     <div class="btn breadcrumbs">@Model.caseSearchFilter.ParantPath_ProductArea</div>
                                     <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
                                         <span class="caret"></span>
                                     </button>
                                     <ul class="dropdown-menu">
                                         <li><a href="#">@Translation.Get("--", Enums.TranslationSource.TextTranslation)</a></li>
                                         @Html.ProductAreaDropdownButtonString(Model.filterProductArea)
                                     </ul>
                                     <input type="hidden" class="hidden" value="@Model.caseSearchFilter.ProductArea" id="hidFilterProductAreaId" name="@CaseSearchFilter.ProductAreaIdNameAttribute" />
                                 </div>
                             </td>
                         </tr>                
                     }
                     @if (Model.filterCategory != null)
                     {
                         <tr>
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.Category_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                 
                             </td>
                             <td>
                                 <select id="lstfilterCategory" name="@CaseSearchFilter.CategoryNameAttribute" data-placeholder="@Translation.Get("Välj en eller flera", Enums.TranslationSource.TextTranslation)" multiple="multiple" class="chosen-select">
                                     @foreach (var e in Model.filterCategory)
                                     {
                                         if (e.IsActive == 1)
                                         {                        
                                             <option value="@e.Id" @e.Id.IdIsSelected(Model.caseSearchFilter.Category)>@e.Name</option>
                                         }
                                     }
                                 </select>
                             </td>
                         </tr>                
                     }
                     @if (Model.filterWorkingGroup != null)
                     {
                         <tr>
                             <td>                                                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.WorkingGroup_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 <select id="lstfilterWorkingGroup" name="@CaseSearchFilter.WorkingGroupNameAttribute" data-placeholder="@Translation.Get("Välj en eller flera", Enums.TranslationSource.TextTranslation)" multiple="multiple" class="chosen-select">
                                     @foreach (var e in Model.filterWorkingGroup)
                                     {
                                         if (e.IsActive == 1)
                                         {                        
                                             <option value="@e.Id" @e.Id.IdIsSelected(Model.caseSearchFilter.WorkingGroup)>@e.WorkingGroupName</option>
                                         }
                                     }
                                 </select>
                             </td>

                         </tr>                
                     }
                     @if (Model.ResponsibleUserList != null)
                     {
                         <tr>
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.CaseResponsibleUser_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                 
                             </td>
                             <td>
                                  @Html.ListBoxFor(m => m.lstfilterResponsible, Model.ResponsibleUserList, new { id = "lstfilterResponsible", @class = "chosen-select", multiple = "multiple" })
                             </td>
                         </tr>                 
                     }  
                    @if (Model.AvailablePerformersList != null)
                    {
                    <tr>
                        <td>                               
                            @Translation.Get(GlobalEnums.TranslationCaseFields.Performer_User_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                        </td>
                        <td>
                            @Html.ListBoxFor(m => m.lstfilterPerformer, Model.AvailablePerformersList, new { id = "lstfilterPerformer", @class = "chosen-select", multiple = "multiple" })
                        </td>
                    </tr>                 
                    }
                     @if (Model.filterPriority != null)
                     {
                         <tr>
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.Priority_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 <select id="lstfilterPriority" name="@CaseSearchFilter.PriorityNameAttribute" data-placeholder="@Translation.Get("Välj en eller flera", Enums.TranslationSource.TextTranslation)" multiple="multiple" class="chosen-select">
                                     @foreach (var e in Model.filterPriority)
                                     {
                                         if (e.IsActive == 1)
                                         {                        
                                             <option value="@e.Id" @e.Id.IdIsSelected(Model.caseSearchFilter.Priority)>@Translation.Get(e.Name, Enums.TranslationSource.TextTranslation)</option>
                                         }
                                     }
                                 </select>
                             </td>
                         </tr>                
                     }
                     @if (Model.filterStatus != null)
                     {
                         <tr>
                             <td>                                                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.Status_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 <select id="lstfilterStatus" name="@CaseSearchFilter.StatusNameAttribute" data-placeholder="@Translation.Get("Välj en eller flera", Enums.TranslationSource.TextTranslation)" multiple="multiple" class="chosen-select">
                                     @foreach (var e in Model.filterStatus)
                                     {
                                         if (e.IsActive == 1)
                                         {                        
                                             <option value="@e.Id" @e.Id.IdIsSelected(Model.caseSearchFilter.Status)>@Translation.Get(e.Name, Enums.TranslationSource.TextTranslation)</option>
                                         }
                                     }
                                 </select>
                             </td>
                         </tr>                
                     }
                     @if (Model.filterStateSecondary != null)
                     {
                         <tr>
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.StateSecondary_Id.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 <select id="lstfilterStateSecondary" name="@CaseSearchFilter.StateSecondaryNameAttribute" data-placeholder="@Translation.Get("Välj en eller flera", Enums.TranslationSource.TextTranslation)" multiple="multiple" class="chosen-select">
                                     @foreach (var e in Model.filterStateSecondary)
                                     {
                                         if (e.IsActive == 1)
                                         {                        
                                             <option value="@e.Id" @e.Id.IdIsSelected(Model.caseSearchFilter.StateSecondary)>@Translation.Get(e.Name, Enums.TranslationSource.TextTranslation)</option>
                                         }
                                     }
                                 </select>
                             </td>
                         </tr>                
                     }
                     @if (Model.customerUserSetting.CaseRegistrationDateFilterShow)
                     {
                         <tr class="date-block">
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.RegTime.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 @Html.EditorFor(m => m.CaseRegistrationDateStartFilter, "DatePickerNoJs")
                                 @Html.EditorFor(m => m.CaseRegistrationDateEndFilter, "DatePickerNoJs")
                             </td>
                         </tr>                
                     }
                     @if (Model.customerUserSetting.CaseWatchDateFilterShow)
                     {
                         <tr class="date-block">
                             <td>                                                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.WatchDate.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                 
                             </td>
                             <td>
                                 @Html.EditorFor(m => Model.CaseWatchDateStartFilter, "DatePickerNoJs")
                                 @Html.EditorFor(m => Model.CaseWatchDateEndFilter, "DatePickerNoJs")
                             </td>
                         </tr>                
                     }
                     @if (Model.customerUserSetting.CaseClosingDateFilterShow)
                     {
                         <tr class="date-block">
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.FinishingDate.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 @Html.EditorFor(m => m.CaseClosingDateStartFilter, "DatePickerNoJs")
                                 @Html.EditorFor(m => m.CaseClosingDateEndFilter, "DatePickerNoJs")
                             </td>
                         </tr>                
                     }
                     @if (Model.ClosingReasons != null)
                     {
                         <tr>
                             <td>                                
                                 @Translation.Get(GlobalEnums.TranslationCaseFields.ClosingReason.ToString(), Enums.TranslationSource.CaseTranslation, Model.filterCustomerId):                                    
                             </td>
                             <td>
                                 <div id="divClosingReason" class="btn-group pull-left">
                                     <div class="btn breadcrumbs">@Model.caseSearchFilter.ParentPathClosingReason</div>
                                     <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
                                         <span class="caret"></span>
                                     </button>
                                     <ul class="dropdown-menu">
                                         <li><a href="#">@Translation.Get("--")</a></li>
                                         @Html.FinishingCauseDropdownButtonString(Model.ClosingReasons)
                                     </ul>
                                     <input type="hidden" class="hidden" value="@Model.caseSearchFilter.CaseClosingReasonFilter" id="hidFilterClosingReasonId" name="@CaseSearchFilter.ClosingReasonNameAttribute" />
                                 </div>
                             </td>
                         </tr>                
                     }
                     <tr>
                         <td>@Translation.Get("Filter")</td>
                         <td>
                             <button class="btn btn-reset">@Translation.Get("Återställ")</button>
                             <button class="btn btn-clear">@Translation.Get("Rensa alla")</button>
                         </td>
                     </tr>
                 </table>
             </div>
         </div>
         <div class="row">
             <div class="span12">
                 <table class="tableform">
                     <tr>
                         <td>@Translation.Get("Mina ärenden")</td>
                         <td colspan="4">@Html.CheckBoxFor(m => m.SearchInMyCasesOnly, new { @class = "switchcheckbox" })</td>
                     </tr>
                     <tr>
                         <td class="span3">
                             @Translation.Get("Sök")
                         </td>
                         <td class="span4">
                             <input type="text" id="txtFreeTextSearch" value="@Model.caseSearchFilter.FreeTextSearch" name="@CaseSearchFilter.FreeTextSearchNameAttribute" 
                                    rel="tooltip" 
                                    title="@Translation.Get("Använd # för att söka efter ärendenummer")" />
                         </td>
                         <td>
                             <select id="lstfilterCaseProgress" name="@CaseSearchFilter.FilterCaseProgressNameAttribute">
                                 @foreach (var e in Model.filterCaseProgress)
                                 {
                                     <option value="@e.Id" @e.Id.IdIsSelected(Model.caseSearchFilter.CaseProgress)>@e.StringValue</option>
                                 }
                             </select>
                         </td>
                         <td>
                             <input type="submit" class="submit btn" value="@Translation.Get("Sök")"/>
                         </td>
                         <td class="span5">
                             <a href="#" id="btnMore">
                                 <i id="icoPlus" class="icon-plus-sign"></i> 
                                 <i id="icoFilter" class="icon-filter"></i>
                             </a>                           
                         </td>
                     </tr>
                 </table>
             </div>            
             <div data-field="caseRemainingTimeHidePlace" style="float: right;"></div>             
         </div>
     </div>
    </form>
}
